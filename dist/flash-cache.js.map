{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1c4b17f14de0b498fee9","webpack:///./src/flash-cache.js","webpack:///./src/listeners.js","webpack:///./src/addToExpiryQueue.js"],"names":["_defaultConfig","defaultExpiryIn","module","exports","flashCache","config","_cache","Object","create","_config","assign","put","key","value","expiryIn","remove","__cache__","time","Date","now","expiryAt","expiryFn","emit","data","bind","get","nCache","isExpired","expired","getAll","clearAll","on","off","_listeners","type","listener","push","splice","indexOf","map","handler","isExisty","val","undefined","_timers","_expiryTimerInstance","_cleanUpTimers","k","hasOwnProperty","_checkExpired","keys","remainingExpiries","length","isTimerActive","clearInterval","setInterval","_addToExpiryQueue","deleteTimerAtKey"],"mappings":"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","file":"flash-cache.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"flashCache\"] = factory();\n\telse\n\t\troot[\"flashCache\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1c4b17f14de0b498fee9\n **/","/**\n * Created by Ganapati on 5/14/17\n *\n * flash-cache: Ultra fast in-memory cache\n */\n\nimport {on, off, emit} from './listeners';\nimport addToExpiryQueue, {deleteTimerAtKey} from './addToExpiryQueue';\n\nlet _defaultConfig = {\n    // Default cache expiry time, 60000ms(60s) by default\n    // Set `false` to disable expiry(This beats the purpose of cache)\n    // `0` will be treated as `false`\n    defaultExpiryIn: 60000\n};\n\n/**\n * flash-cache: Ultra fast in-memory cache\n */\nmodule.exports = function flashCache(config = _defaultConfig) {\n    let _cache = Object.create(null);\n\n    return {\n        /**\n         * Expose config copy for future use\n         * */\n        _config: Object.assign({}, config),\n\n        /**\n         * Put data into cache\n         *\n         * @param {String} key  Cache key\n         * @param {String|Object} value Value to be stored against cache key\n         * @param {Number} expiryIn Expiry time for the key, defaults to defaultExpiryIn\n         * */\n        put(key = '', value = '', expiryIn = config.defaultExpiryIn) {\n            // Remove existing values in the key, if any\n            if (_cache[key]) {\n                this.remove(key, true);\n            }\n\n            let __cache__ = {\n                value,\n                time: Date.now()\n            };\n\n            __cache__.value = value;\n\n            // Ignore all falsy values(like `0` & `false`)\n            // Basically if there is no expiry, cache will act as simple in-memory data store\n            if (expiryIn) {\n                // Store timeout, might be required for later use\n                __cache__.expiryAt = __cache__.time + expiryIn;\n\n                let expiryFn = () => {\n                    // Trigger `fc-expiry` event\n                    this.emit('fc-expiry', {key, data: _cache[key]});\n\n                    this.remove(key, true);\n                };\n\n                // Remove the cache after expiry time\n                addToExpiryQueue(__cache__.expiryAt, key, expiryFn.bind(this));\n            }\n\n            _cache[key] = __cache__;\n\n            // Trigger `fc-add` event\n            this.emit('fc-add', {key, data: _cache[key]});\n\n            return _cache[key];\n        },\n\n        /**\n         * Get data from cache\n         *\n         * @param {String} key  Cache key\n         * */\n        get(key = '') {\n            let __cache__ = _cache[key];\n\n            if (__cache__) {\n                // Make a new copy of cache\n                // Note: this won't remove nested references\n                let nCache = Object.assign({}, __cache__);\n\n                // Trigger `fc-get` event\n                this.emit('fc-get', {key, data: nCache});\n\n                return nCache;\n            }\n\n            return null;\n        },\n\n        /**\n         * Remove data/Invalidate from cache\n         *\n         * @param {String} key  Cache key to be removed\n         * @param {Boolean} isExpired  Boolean to indicate whether cache is removed by expiry timeout\n         * */\n        remove(key, isExpired = false) {\n            let __cache__ = _cache[key];\n\n            if (__cache__) {\n                let {expiryAt} = __cache__;\n\n                // If timer exists for the key, remove it\n                deleteTimerAtKey(expiryAt, key);\n\n                // Remove key & value from cache\n                delete _cache[key];\n\n                // Trigger `fc-remove` event\n                this.emit('fc-remove', {key, expired: isExpired});\n\n                return true;\n            }\n\n            return false;\n        },\n\n        /**\n         * Get entire cache\n         * */\n        getAll() {\n            // Trigger `fc-get-all` event\n            this.emit('fc-get-all', _cache);\n\n            return _cache;\n        },\n\n        /**\n         * Clear entire cache\n         * */\n        clearAll() {\n            _cache = Object.create(null);\n\n            // Trigger `fc-clear` event\n            this.emit('fc-clear', {});\n\n            return true;\n        },\n\n        /**\n         * Event listeners\n         * */\n        on,\n        off,\n        emit\n    }\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/flash-cache.js\n **/","/**\n * Created by Ganapati on 6/24/17\n *\n * Event listeners\n */\n\nlet _listeners = Object.create(null);\n\n/**\n * Add cache event listener\n * Snippet borrowed from @developit/mitt\n *\n * @param {String} type  Event to register, Eg: add, remove, expiry\n * @param {String|Object} listener Function to be called on event\n * */\nexport let on = (type, listener) => {\n    if (typeof listener === 'function') {\n        (_listeners[type] || (_listeners[type] = [])).push(listener);\n    }\n};\n\n/**\n * Remove cache event listener\n * Snippet borrowed from @developit/mitt\n *\n * @param {String} type  Event to un register, Eg: add, remove, expiry\n * @param {String|Object} listener function to remove\n * */\nexport let off = (type, listener) => {\n    if (_listeners[type]) {\n        _listeners[type].splice(_listeners[type].indexOf(listener) >>> 0, 1);\n    }\n};\n\n/**\n * Emit data to cache event listeners\n * Snippet borrowed from @developit/mitt\n *\n * @param {String} type  Event to be emited\n * @param {String|Object} data to pass to listener function\n * */\nexport let emit = (type, data) => {\n    (_listeners[type] || []).map((handler) => {\n        handler(data);\n    });\n    (_listeners['*'] || []).map((handler) => {\n        handler(type, data);\n    });\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/listeners.js\n **/","/**\n * Created by Ganapati on 7/05/17\n *\n * Timers - Expire cache on time(on regular intervals)\n */\n\n/**\n * Check if variable has some value\n * */\nlet isExisty = (val) => val !== null && val !== undefined;\n\n/**\n * Store each key's expiry functions in _timers[expiryAt][key]\n * */\nlet _timers = {};\nlet _expiryTimerInstance = null;\n\n/**\n * Expire all keys at time(key) - _timers[time] & remove key from _timers\n * */\nlet _cleanUpTimers = (key) => {\n    if (_timers[key]) {\n        for (let k in _timers[key]) {\n            if (_timers[key].hasOwnProperty(k)) {\n                _timers[key][k]();\n            }\n        }\n        delete _timers[key];\n    }\n};\n\n/**\n * Check for keys expiry each 1 millisecond unless all keys are expired\n *\n * Cleanup current + old keys(If any)\n *\n * If no keys exists to expire, stop timer or if timer is not started, attach timer\n * */\nlet _checkExpired = () => {\n    let keys = Object.keys(_timers);\n    let remainingExpiries = keys.length;\n    let now = Date.now();\n    let isTimerActive = isExisty(_expiryTimerInstance);\n\n    keys.map(k => {\n        if (k <= now) {\n            _cleanUpTimers(k);\n            remainingExpiries -= 1;\n        }\n    });\n\n    if (!remainingExpiries) {\n        clearInterval(_expiryTimerInstance);\n        _expiryTimerInstance = null;\n    }\n    else if (!isTimerActive) {\n        _expiryTimerInstance = setInterval(_checkExpired, 1);\n    }\n};\n\n/**\n * Add expiryFn to _timers[expiryAt][key] & start timer if timer not attached\n * */\nlet _addToExpiryQueue = (expiryAt, key, expiryFn) => {\n    if (!_timers[expiryAt]) {\n        _timers[expiryAt] = {};\n    }\n    _timers[expiryAt][key] = expiryFn;\n    _checkExpired();\n};\n\nexport let deleteTimerAtKey = (expiryAt, key) => {\n    if (_timers[expiryAt][key]) {\n        delete _timers[expiryAt][key];\n    }\n};\n\nexport default _addToExpiryQueue;\n\n\n/** WEBPACK FOOTER **\n ** ./src/addToExpiryQueue.js\n **/"],"sourceRoot":""}