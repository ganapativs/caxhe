{"version":3,"sources":["flash-cache.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_listeners","_addToExpiryQueue","_addToExpiryQueue2","_defaultConfig","defaultExpiryIn","config","arguments","length","undefined","_cache","Object","create","_config","assign","put","key","_this","value","expiryIn","remove","__cache__","time","Date","now","expiryAt","expiryFn","emit","data","bind","get","nCache","isExpired","deleteTimerAtKey","expired","getAll","clearAll","on","off","defineProperty","type","listener","push","splice","indexOf","map","handler","isExisty","val","_timers","_expiryTimerInstance","_cleanUpTimers","k","hasOwnProperty","_checkExpired","keys","remainingExpiries","isTimerActive","setInterval","clearInterval"],"mappings":"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","file":"flash-cache.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"flashCache\"] = factory();\n\telse\n\t\troot[\"flashCache\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _listeners = __webpack_require__(1);\n\t\n\tvar _addToExpiryQueue = __webpack_require__(2);\n\t\n\tvar _addToExpiryQueue2 = _interopRequireDefault(_addToExpiryQueue);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Created by Ganapati on 5/14/17\n\t *\n\t * flash-cache: Ultra fast in-memory cache\n\t */\n\t\n\tvar _defaultConfig = {\n\t    // Default cache expiry time, 60000ms(60s) by default\n\t    // Set `false` to disable expiry(This beats the purpose of cache)\n\t    // `0` will be treated as `false`\n\t    defaultExpiryIn: 60000\n\t};\n\t\n\t/**\n\t * flash-cache: Ultra fast in-memory cache\n\t */\n\tmodule.exports = function flashCache() {\n\t    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _defaultConfig;\n\t\n\t    var _cache = Object.create(null);\n\t\n\t    return {\n\t        /**\n\t         * Expose config copy for future use\n\t         * */\n\t        _config: Object.assign({}, config),\n\t\n\t        /**\n\t         * Put data into cache\n\t         *\n\t         * @param {String} key  Cache key\n\t         * @param {String|Object} value Value to be stored against cache key\n\t         * @param {Number} expiryIn Expiry time for the key, defaults to defaultExpiryIn\n\t         * */\n\t        put: function put() {\n\t            var key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\t\n\t            var _this = this;\n\t\n\t            var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\t            var expiryIn = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : config.defaultExpiryIn;\n\t\n\t            // Remove existing values in the key, if any\n\t            if (_cache[key]) {\n\t                this.remove(key, true);\n\t            }\n\t\n\t            var __cache__ = {\n\t                value: value,\n\t                time: Date.now()\n\t            };\n\t\n\t            __cache__.value = value;\n\t\n\t            // Ignore all falsy values(like `0` & `false`)\n\t            // Basically if there is no expiry, cache will act as simple in-memory data store\n\t            if (expiryIn) {\n\t                // Store timeout, might be required for later use\n\t                __cache__.expiryAt = __cache__.time + expiryIn;\n\t\n\t                var expiryFn = function expiryFn() {\n\t                    // Trigger `fc-expiry` event\n\t                    _this.emit('fc-expiry', { key: key, data: _cache[key] });\n\t\n\t                    _this.remove(key, true);\n\t                };\n\t\n\t                // Remove the cache after expiry time\n\t                (0, _addToExpiryQueue2.default)(__cache__.expiryAt, key, expiryFn.bind(this));\n\t            }\n\t\n\t            _cache[key] = __cache__;\n\t\n\t            // Trigger `fc-add` event\n\t            this.emit('fc-add', { key: key, data: _cache[key] });\n\t\n\t            return _cache[key];\n\t        },\n\t\n\t\n\t        /**\n\t         * Get data from cache\n\t         *\n\t         * @param {String} key  Cache key\n\t         * */\n\t        get: function get() {\n\t            var key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\t\n\t            var __cache__ = _cache[key];\n\t\n\t            if (__cache__) {\n\t                // Make a new copy of cache\n\t                // Note: this won't remove nested references\n\t                var nCache = Object.assign({}, __cache__);\n\t\n\t                // Trigger `fc-get` event\n\t                this.emit('fc-get', { key: key, data: nCache });\n\t\n\t                return nCache;\n\t            }\n\t\n\t            return null;\n\t        },\n\t\n\t\n\t        /**\n\t         * Remove data/Invalidate from cache\n\t         *\n\t         * @param {String} key  Cache key to be removed\n\t         * @param {Boolean} isExpired  Boolean to indicate whether cache is removed by expiry timeout\n\t         * */\n\t        remove: function remove(key) {\n\t            var isExpired = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\n\t            var __cache__ = _cache[key];\n\t\n\t            if (__cache__) {\n\t                var expiryAt = __cache__.expiryAt;\n\t\n\t                // If timer exists for the key, remove it\n\t\n\t                (0, _addToExpiryQueue.deleteTimerAtKey)(expiryAt, key);\n\t\n\t                // Remove key & value from cache\n\t                delete _cache[key];\n\t\n\t                // Trigger `fc-remove` event\n\t                this.emit('fc-remove', { key: key, expired: isExpired });\n\t\n\t                return true;\n\t            }\n\t\n\t            return false;\n\t        },\n\t\n\t\n\t        /**\n\t         * Get entire cache\n\t         * */\n\t        getAll: function getAll() {\n\t            // Trigger `fc-get-all` event\n\t            this.emit('fc-get-all', _cache);\n\t\n\t            return _cache;\n\t        },\n\t\n\t\n\t        /**\n\t         * Clear entire cache\n\t         * */\n\t        clearAll: function clearAll() {\n\t            _cache = Object.create(null);\n\t\n\t            // Trigger `fc-clear` event\n\t            this.emit('fc-clear', {});\n\t\n\t            return true;\n\t        },\n\t\n\t\n\t        /**\n\t         * Event listeners\n\t         * */\n\t        on: _listeners.on,\n\t        off: _listeners.off,\n\t        emit: _listeners.emit\n\t    };\n\t};\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t/**\n\t * Created by Ganapati on 6/24/17\n\t *\n\t * Event listeners\n\t */\n\t\n\tvar _listeners = Object.create(null);\n\t\n\t/**\n\t * Add cache event listener\n\t * Snippet borrowed from @developit/mitt\n\t *\n\t * @param {String} type  Event to register, Eg: add, remove, expiry\n\t * @param {String|Object} listener Function to be called on event\n\t * */\n\tvar on = exports.on = function on(type, listener) {\n\t    if (typeof listener === 'function') {\n\t        (_listeners[type] || (_listeners[type] = [])).push(listener);\n\t    }\n\t};\n\t\n\t/**\n\t * Remove cache event listener\n\t * Snippet borrowed from @developit/mitt\n\t *\n\t * @param {String} type  Event to un register, Eg: add, remove, expiry\n\t * @param {String|Object} listener function to remove\n\t * */\n\tvar off = exports.off = function off(type, listener) {\n\t    if (_listeners[type]) {\n\t        _listeners[type].splice(_listeners[type].indexOf(listener) >>> 0, 1);\n\t    }\n\t};\n\t\n\t/**\n\t * Emit data to cache event listeners\n\t * Snippet borrowed from @developit/mitt\n\t *\n\t * @param {String} type  Event to be emited\n\t * @param {String|Object} data to pass to listener function\n\t * */\n\tvar emit = exports.emit = function emit(type, data) {\n\t    (_listeners[type] || []).map(function (handler) {\n\t        handler(data);\n\t    });\n\t    (_listeners['*'] || []).map(function (handler) {\n\t        handler(type, data);\n\t    });\n\t};\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t/**\n\t * Created by Ganapati on 7/05/17\n\t *\n\t * Timers - Expire cache on time(on regular intervals)\n\t */\n\t\n\t/**\n\t * Check if variable has some value\n\t * */\n\tvar isExisty = function isExisty(val) {\n\t    return val !== null && val !== undefined;\n\t};\n\t\n\t/**\n\t * Store each key's expiry functions in _timers[expiryAt][key]\n\t * */\n\tvar _timers = {};\n\tvar _expiryTimerInstance = null;\n\t\n\t/**\n\t * Expire all keys at time(key) - _timers[time] & remove key from _timers\n\t * */\n\tvar _cleanUpTimers = function _cleanUpTimers(key) {\n\t    if (_timers[key]) {\n\t        for (var k in _timers[key]) {\n\t            if (_timers[key].hasOwnProperty(k)) {\n\t                _timers[key][k]();\n\t            }\n\t        }\n\t        delete _timers[key];\n\t    }\n\t};\n\t\n\t/**\n\t * Check for keys expiry each 1 millisecond unless all keys are expired\n\t *\n\t * Cleanup current + old keys(If any)\n\t *\n\t * If no keys exists to expire, stop timer or if timer is not started, attach timer\n\t * */\n\tvar _checkExpired = function _checkExpired() {\n\t    var keys = Object.keys(_timers);\n\t    var remainingExpiries = keys.length;\n\t    var now = Date.now();\n\t    var isTimerActive = isExisty(_expiryTimerInstance);\n\t\n\t    keys.map(function (k) {\n\t        if (k <= now) {\n\t            _cleanUpTimers(k);\n\t            remainingExpiries -= 1;\n\t        }\n\t    });\n\t\n\t    if (!remainingExpiries) {\n\t        clearInterval(_expiryTimerInstance);\n\t        _expiryTimerInstance = null;\n\t    } else if (!isTimerActive) {\n\t        _expiryTimerInstance = setInterval(_checkExpired, 1);\n\t    }\n\t};\n\t\n\t/**\n\t * Add expiryFn to _timers[expiryAt][key] & start timer if timer not attached\n\t * */\n\tvar _addToExpiryQueue = function _addToExpiryQueue(expiryAt, key, expiryFn) {\n\t    if (!_timers[expiryAt]) {\n\t        _timers[expiryAt] = {};\n\t    }\n\t    _timers[expiryAt][key] = expiryFn;\n\t    _checkExpired();\n\t};\n\t\n\tvar deleteTimerAtKey = exports.deleteTimerAtKey = function deleteTimerAtKey(expiryAt, key) {\n\t    if (_timers[expiryAt][key]) {\n\t        delete _timers[expiryAt][key];\n\t    }\n\t};\n\t\n\texports.default = _addToExpiryQueue;\n\n/***/ }\n/******/ ])\n});\n;\n"],"sourceRoot":"/source/"}